%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%% File: xor.m 			     %%%%%%%%%%%%%%%%
%%%%%% Author: Saurav Keshari Aryal  %%%%%%%%%%%%%%%%%%
%%%%%% Script file that uses an elementary perceptron to classify images%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

hat1 =     [ 0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 1 1 0 0 0 0 0 0 ...
             0 1 1 1 1 0 0 0 0 0 ...
             1 1 1 1 1 1 0 0 0 0 ...
             1 1 1 1 1 1 0 0 0 0 ...
             1 1 1 1 1 1 1 1 1 1 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ]'; 
     
face1 =    [ 0 0 1 0 0 0 0 1 0 0 ...
             0 1 0 1 1 1 1 0 1 0 ...
             1 0 0 0 0 0 0 0 0 1 ...
             1 0 1 1 0 0 1 1 0 1 ...
             1 0 0 0 0 0 0 0 0 1 ...
             1 0 0 0 0 0 0 0 0 1 ...
             0 1 0 0 1 1 0 0 1 0 ...
             0 0 1 0 0 0 0 1 0 0 ...
             0 0 0 1 0 0 1 0 0 0 ...
             0 0 0 0 1 1 0 0 0 0 ]'; 
     
robbery1 = [ 0 1 1 1 0 0 0 0 0 0 ...
             0 1 1 1 0 0 0 0 0 0 ...
             0 1 1 1 0 0 0 0 0 0 ...
             0 1 1 0 0 0 1 1 1 0 ...
             0 1 1 1 1 1 0 0 0 0 ...
             0 1 0 0 0 0 0 0 0 0 ...
             0 1 1 0 0 0 0 0 0 0 ...
             0 1 0 1 0 0 0 0 0 0 ...
             0 1 0 1 0 0 0 0 0 0 ...
             0 1 1 1 1 0 0 0 0 0 ]';
     
robbery2 = [ 0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 1 1 0 0 0 0 1 1 0 ...
             0 1 1 0 0 0 0 1 1 0 ...
             0 1 0 0 1 0 0 0 1 0 ...
             0 1 1 1 1 0 0 0 1 0 ...
             0 1 0 0 1 0 0 0 1 0 ...
             0 1 0 0 0 0 0 0 1 0 ...
             0 1 0 0 0 0 0 0 1 0 ...
             0 1 1 0 0 0 0 1 1 0 ]';
     
hat2 =     [ 0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             1 1 1 1 1 1 1 1 1 1 ...
             0 0 0 0 0 0 0 0 0 0 ]';
     
robbery3 = [ 0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 1 0 0 0 0 0 ...
             0 0 0 1 0 1 0 0 0 0 ...
             0 0 0 0 1 0 0 0 0 0 ...
             0 0 0 0 1 0 0 0 0 0 ...
             0 0 0 1 1 1 0 0 0 0 ...
             0 0 0 0 1 0 0 0 0 0 ...
             0 0 0 1 0 1 0 0 0 0 ...
             0 0 0 1 0 1 0 0 0 0 ...
             0 0 1 1 0 1 1 0 0 0 ]';
    
hat3 =     [ 0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 1 1 1 1 0 0 0 ...
             0 0 0 1 1 1 1 0 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             1 1 1 1 1 1 1 1 1 1 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ]';
    
robbery4 = [ 0 0 0 0 1 0 0 0 0 0 ...
             0 0 0 1 1 1 0 0 0 0 ...
             0 0 0 1 1 1 0 0 0 0 ...
             0 0 0 0 1 0 0 0 0 0 ...
             0 0 0 1 1 1 0 0 0 0 ...
             0 0 0 1 1 1 0 0 0 0 ...
             0 0 0 1 1 1 0 0 0 0 ...
             0 0 0 1 1 1 0 0 0 0 ...
             0 0 1 1 1 1 1 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ]';
     
face2 =    [ 0 0 1 1 1 1 1 1 0 0 ...
             0 1 0 0 0 0 0 0 1 0 ...
             1 0 1 0 0 0 0 1 0 1 ...
             1 0 0 0 1 1 0 0 0 1 ...
             1 0 0 0 1 1 0 0 0 1 ...
             1 0 0 0 0 0 0 0 0 1 ...
             1 0 0 1 1 1 1 0 0 1 ...
             1 0 0 0 0 0 0 0 0 1 ...
             0 1 0 0 0 0 0 0 1 0 ...
             0 0 1 1 1 1 1 1 0 0 ]';
     
hat4 =     [ 0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             1 1 1 1 1 1 1 1 1 1 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ]';
     
face3 =    [ 0 0 0 1 1 1 0 0 0 0 ...
             0 0 1 0 0 0 1 0 0 0 ...
             0 0 1 1 0 1 1 0 0 0 ...
             0 0 1 0 0 0 1 0 0 0 ...
             0 0 1 0 1 0 1 0 0 0 ...
             0 0 1 0 0 0 1 0 0 0 ...
             0 0 1 1 1 1 1 0 0 0 ...
             0 0 1 0 0 0 1 0 0 0 ...
             0 0 0 1 1 1 0 0 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ]';
     
face4 =    [ 0 0 0 0 0 0 0 0 0 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 1 0 0 0 0 0 0 1 0 ...
             0 1 0 1 0 0 1 0 1 0 ...
             0 1 0 0 1 1 0 0 1 0 ...
             0 1 0 0 0 0 0 0 1 0 ...
             0 1 0 1 1 1 1 0 1 0 ...
             0 1 1 0 0 0 0 1 1 0 ...
             0 0 1 1 1 1 1 1 0 0 ...
             0 0 0 0 0 0 0 0 0 0 ]';
     
samples = [hat1,face1,robbery1,robbery2,hat2,robbery3,...
           hat3,robbery4,face2,hat4,face3,face4];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%% File: percepta.m 			     %%%%%%%%%%%%%%%%
%%%%%% Author: Saurav Keshari Aryal  %%%%%%%%%%%%%%%%%%
%%%%%% Script file that uses an elementary perceptron to classify images%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% number of samples of each class
K = 4;
hats = [hat1, hat2, hat3, hat4];
faces = [face1, face2, face3, face4];
robberries = [robbery1, robbery2, robbery3, robbery4];
%unclassed = []

% define output coding for classes
a = [0 1]'; %hats
b = [1 1]'; %faces
c = [1 0]'; %robberies
d = [0 0]'; %unclassified

% define targets
T = [a, b, c, c, a, c, a, c, b, a, b, b];
%  IW: containing 1 input weight matrix
% LW:  containing 0 layer weight matrices
% b: containing 1 bias vector
net = perceptron;
net.init;
dlmwrite('Initialize.txt', net.IW);
dlmwrite('Initialize2.txt', net.LW);
dlmwrite('Initialize3.txt', net.b);

E = 1;
net.adaptParam.passes = 1;

n = 0;

while (sse(E) & n<1000)
   n = n+1;
   [net,Y,E] = adapt(net,samples,T);
end
dlmwrite('Finalize.txt', net.IW);
dlmwrite('Finalize2.txt', net.LW);
dlmwrite('Finalize3.txt', net.b);
